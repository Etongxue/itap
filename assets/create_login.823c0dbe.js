var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{a4 as n,ay as i,U as d,a2 as u,cc as c,W as p,X as m,I as f,aE as g,aB as v,az as h,A as b,dr as y,r as w,k as _,x,b1 as V,bo as k,bD as I,bp as T,a1 as C,ci as A,c7 as P,dx as D,cq as z,Q as U,dy as j,aw as F,D as q,cb as E,aS as S,V as B,b3 as O,bn as L,c9 as M,ac as K,bf as H}from"./save_config.7e387697.js";import{E as R}from"./el-overlay.e22515de.js";import{E as Q}from"./el-input.07836306.js";import{E as W,a as X}from"./el-form-item.9774cccc.js";import{E as G}from"./el-radio.2ecd3578.js";import{e as J}from"./main.5f87c81f.js";var N=n({name:"Lock"});const Y={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Z=u("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32H224zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96z"},null,-1),$=u("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32zm192-160v-64a192 192 0 1 0-384 0v64h384zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64z"},null,-1);N.render=function(e,a,l,t,o,s){return i(),d("svg",Y,[Z,$])},N.__file="packages/components/Lock.vue";var ee=N,ae=n({name:"User"});const le={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},te=u("path",{fill:"currentColor",d:"M512 512a192 192 0 1 0 0-384 192 192 0 0 0 0 384zm0 64a256 256 0 1 1 0-512 256 256 0 0 1 0 512zm320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0z"},null,-1);ae.render=function(e,a,l,t,o,s){return i(),d("svg",le,[te])},ae.__file="packages/components/User.vue";var oe=ae;const se="function"==typeof btoa,re="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;const ne="function"==typeof TextEncoder?new TextEncoder:void 0,ie=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");(e=>{let a={};ie.forEach(((e,l)=>a[e]=l))})();const de=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);const ue=se?e=>btoa(e):re?e=>Buffer.from(e,"binary").toString("base64"):e=>{let a,l,t,o,s="";const r=e.length%3;for(let n=0;n<e.length;){if((l=e.charCodeAt(n++))>255||(t=e.charCodeAt(n++))>255||(o=e.charCodeAt(n++))>255)throw new TypeError("invalid character found");a=l<<16|t<<8|o,s+=ie[a>>18&63]+ie[a>>12&63]+ie[a>>6&63]+ie[63&a]}return r?s.slice(0,r-3)+"===".substring(r):s},ce=re?e=>Buffer.from(e).toString("base64"):e=>{let a=[];for(let l=0,t=e.length;l<t;l+=4096)a.push(de.apply(null,e.subarray(l,l+4096)));return ue(a.join(""))},pe=e=>{if(e.length<2)return(a=e.charCodeAt(0))<128?e:a<2048?de(192|a>>>6)+de(128|63&a):de(224|a>>>12&15)+de(128|a>>>6&63)+de(128|63&a);var a=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return de(240|a>>>18&7)+de(128|a>>>12&63)+de(128|a>>>6&63)+de(128|63&a)},me=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,fe=re?e=>Buffer.from(e,"utf8").toString("base64"):ne?e=>ce(ne.encode(e)):e=>ue(e.replace(me,pe)),ge=(e,a=!1)=>a?(e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")))(fe(e)):fe(e);const ve={class:"d-flex-between login-third"},he=(e=>(v("data-v-79b59598"),e=e(),h(),e))((()=>m("div",null,"第三方账号登录",-1))),be={class:"d-flex"},ye=["href","onClick"],we=["src"];var _e=c({emits:["loginThird"],setup(e,{emit:a}){const l=[{url:"https://api.weibo.com/oauth2/authorize?client_id=3805380913&redirect_uri=https://www.codelife.cc/logincb&response_type=code&state=&scope=all",icon:"weibo"},{url:"https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101983660&redirect_uri=https%3A%2F%2Fwww.codelife.cc%2Flogincb&state=qq",icon:"qq"},{url:"https://github.com/login/oauth/authorize?client_id=930860aee1b7c1ce56ee&scope=user",icon:"github"}];return(e,t)=>(i(),p("div",ve,[he,m("div",be,[(i(),p(f,null,g(l,(e=>m("span",{href:e.url,key:e.icon,onClick:l=>(e=>{window.open(e.url,"_blank","width=800,height=500"),window.addEventListener("meessage",(e=>{let l=e.data||{};a("loginThird",l)}),!1)})(e)},[m("img",{style:{width:"24px",height:"24px"},src:`./login/${e.icon}.svg`},null,8,we)],8,ye))),64))])]))}},[["__scopeId","data-v-79b59598"]]);const xe=e=>(v("data-v-59dce5ef"),e=e(),h(),e),Ve=[xe((()=>m("span",{class:"brid-body"},null,-1))),xe((()=>m("span",{class:"brid-claw left"},null,-1))),xe((()=>m("span",{class:"brid-claw right"},null,-1)))];var ke=c({props:{inputPass:{type:Boolean,defautl:!1}},setup(e){const a=e;return(e,l)=>(i(),p("div",null,[m("div",{class:b(["login-bird",{password:a.inputPass}])},Ve,2)]))}},[["__scopeId","data-v-59dce5ef"]]);const Ie=e=>(v("data-v-75061984"),e=e(),h(),e),Te=Ie((()=>m("div",{class:"ar",style:{margin:"-15px 0 10px 0"}},[m("a",{class:"d-main f12",target:"_blank",href:"https://codelife.cc/account/pass?type=find"},"忘记密码")],-1))),Ce=C("立即登录"),Ae=Ie((()=>m("div",null,[m("h2",{class:"ac f18 mb10 pt30"},"选择账号数据")],-1))),Pe=Ie((()=>m("p",{class:"f12 d-sub ac"},"检测到云端数据和本地数据不一致，请选择使用其中某一项数据",-1))),De={style:{padding:"20px 40px 40px"}},ze=C("使用本地数据"),Ue=C("使用云端数据"),je={class:"ac mt30"},Fe=C("确定");var qe=c({emits:["close"],setup(e,{emit:a}){const l=y(),t=w({email:"",password:""}),o=w({loading:!1,userInfo:{},selectDataVisible:!1,dataActive:2,isInputPass:!1}),s=_(null),r=()=>{o.loading=!0;let e={};e.email=t.email,e.from="itab",e.password=ge(t.password),e.t=(new Date).getTime(),A.userLogin(e).then((e=>{200==e.code&&n(e)})).finally((()=>{o.loading=!1}))};function n(e){if(o.userInfo=e.data||{},!e.token)return;o.userInfo.token=e.token;let t=!1;o.userInfo.upTime&&(t=!0);for(let a in o.userInfo.itabAsyncTime)1!=o.userInfo.itabAsyncTime[a]&&(t=!0);t?o.selectDataVisible=!0:(l.value=o.userInfo,P.set("token",o.userInfo.token),a("close"))}function d(){l.value=o.userInfo,P.set("token",o.userInfo.token),2==o.dataActive?D(null,o.userInfo.itabAsyncTime):z(null),o.selectDataVisible=!1,a("close")}return(e,a)=>(i(),p("div",null,[u(ke,{inputPass:x(o).isInputPass},null,8,["inputPass"]),u(x(X),{onSubmit:a[4]||(a[4]=T((()=>{}),["prevent"])),size:"large",model:x(t),ref_key:"refLoginForm",ref:s,"label-position":"right"},{default:V((()=>[u(x(W),{prop:"email",rules:{required:!0,type:"email",meessage:"邮箱格式不正确"}},{default:V((()=>[u(x(Q),{"prefix-icon":x(oe),maxlength:"40",modelValue:x(t).email,"onUpdate:modelValue":a[0]||(a[0]=e=>x(t).email=e),placeholder:"请输入邮箱"},null,8,["prefix-icon","modelValue"])])),_:1}),u(x(W),{prop:"password",rules:{required:!0,meessage:"密码不能为空"}},{default:V((()=>[u(x(Q),{onKeydown:k(r,["enter"]),maxlength:"20","show-password":"","prefix-icon":x(ee),type:"password",modelValue:x(t).password,"onUpdate:modelValue":a[1]||(a[1]=e=>x(t).password=e),onFocus:a[2]||(a[2]=e=>x(o).isInputPass=!0),onBlur:a[3]||(a[3]=e=>x(o).isInputPass=!1),placeholder:"请输入6-18位密码"},null,8,["onKeydown","prefix-icon","modelValue"])])),_:1}),Te,u(x(I),{round:"",onClick:r,type:"primary",class:"mb20 wfull",loading:x(o).loading},{default:V((()=>[Ce])),_:1},8,["loading"])])),_:1},8,["model"]),u(_e,{onLoginThird:n}),u(x(R),{"append-to-body":!0,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,modelValue:x(o).selectDataVisible,"onUpdate:modelValue":a[7]||(a[7]=e=>x(o).selectDataVisible=e)},{default:V((()=>[Ae,Pe,m("div",De,[m("p",null,[u(x(G),{modelValue:x(o).dataActive,"onUpdate:modelValue":a[5]||(a[5]=e=>x(o).dataActive=e),label:1},{default:V((()=>[ze])),_:1},8,["modelValue"])]),m("p",null,[u(x(G),{modelValue:x(o).dataActive,"onUpdate:modelValue":a[6]||(a[6]=e=>x(o).dataActive=e),label:2},{default:V((()=>[Ue])),_:1},8,["modelValue"])]),m("p",je,[u(x(I),{onClick:d,class:"wfull",type:"primary"},{default:V((()=>[Fe])),_:1})])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-75061984"]]);const Ee={class:"d-flex-between wfull"},Se=C("立即注册 "),Be={emits:["close"],setup(e,{emit:n}){const d=y(),c=w({timer:null,loading:!1,timerText:"获取验证码",setp:0,isInputPass:!1}),f=w({email:"",username:"",password:"",verifyKey:"",source:J()}),g=_(null);const v=U((()=>!j(f.email)));U((()=>!j(f.email)));const h=()=>{j(f.email)?(c.timerText=10,c.timer=setInterval((()=>{c.timerText--,c.timerText<=0&&(clearInterval(c.timer),c.timerText="获取验证码")}),1e3),A.userSendVerifyCode({email:f.email}).then((e=>{E.success("验证码发送成功")}))):E.warning("请输入正确的邮箱")};function b(){g.value.validate((e=>{if(!e)return;c.loading=!0;let i=(u=((e,a)=>{for(var l in a||(a={}))o.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))s.call(a,l)&&r(e,l,a[l]);return e})({},f),p={password:ge(f.password)},a(u,l(p)));var u,p;i.t=(new Date).getTime(),A.userRegistry(i).then((e=>{let a=e.data||{};d.value=a,P.set("token",e.token),E.success("注册成功"),n("close")})).finally((()=>{c.loading=!1}))}))}return F((()=>{clearInterval(c.timer)})),(e,a)=>(i(),p("div",null,[u(ke,{inputPass:x(c).isInputPass},null,8,["inputPass"]),u(x(X),{onSubmit:a[6]||(a[6]=T((()=>{}),["prevent"])),size:"default",model:x(f),ref_key:"refLoginForm",ref:g,"label-position":"right"},{default:V((()=>[u(x(W),{prop:"email",rules:{required:!0,type:"email",meessage:"邮箱格式不正确"}},{default:V((()=>[m("div",Ee,[u(x(Q),{autocomplete:"off",maxlength:"40",modelValue:x(f).email,"onUpdate:modelValue":a[0]||(a[0]=e=>x(f).email=e),modelModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["modelValue"]),u(x(I),{style:{width:"90px"},type:"primary",class:"ml5",disabled:x(v)||"获取验证码"!=x(c).timerText,onClick:h},{default:V((()=>[C(q(x(c).timerText),1)])),_:1},8,["disabled"])])])),_:1}),u(x(W),{prop:"verifyKey",rules:{required:!0,meessage:"验证码不能为空"}},{default:V((()=>[u(x(Q),{autocomplete:"off",maxlength:"6",modelValue:x(f).verifyKey,"onUpdate:modelValue":a[1]||(a[1]=e=>x(f).verifyKey=e),placeholder:"请输入6位邮箱验证码"},null,8,["modelValue"])])),_:1}),u(x(W),{prop:"username",rules:{required:!0,meessage:"请输入用户名"}},{default:V((()=>[u(x(Q),{autocomplete:"off",maxlength:"18",modelValue:x(f).username,"onUpdate:modelValue":a[2]||(a[2]=e=>x(f).username=e),modelModifiers:{trim:!0},placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),u(x(W),{prop:"password",rules:{required:!0,meessage:"密码不能为空"}},{default:V((()=>[u(x(Q),{autocomplete:"off",maxlength:"20","show-password":"",type:"password",onFocus:a[3]||(a[3]=e=>x(c).isInputPass=!0),onBlur:a[4]||(a[4]=e=>x(c).isInputPass=!1),modelValue:x(f).password,"onUpdate:modelValue":a[5]||(a[5]=e=>x(f).password=e),placeholder:"请输入8-18密码"},null,8,["modelValue"])])),_:1}),u(x(I),{size:"large",round:"",loading:x(c).loading,onClick:b,type:"primary",class:"wfull"},{default:V((()=>[Se])),_:1},8,["loading"])])),_:1},8,["model"])]))}};const Oe={class:"app-login hfull"},Le=(e=>(v("data-v-24057d48"),e=e(),h(),e))((()=>m("h2",{class:"b f18 ac"},"欢迎使用iTab",-1))),Me={class:"login-tip ac"},Ke={key:0,class:"mt5"},He={class:"pl30 pr30 mb30"},Re={class:"ac mt5"};var Qe=c({props:{type:String},setup(e){const a=e,l=S(),t=_(a.type);function o(){l.onClose()}return(e,a)=>(i(),d(x(R),{"custom-class":"login-dialog","close-on-press-escape":!1,"close-on-click-modal":!1,width:"420px"},{default:V((()=>[m("div",Oe,[Le,m("div",Me,["firefox"==x(J)()?(i(),p("p",Ke,"火狐暂不支持第三方登录")):B("",!0)]),m("div",He,[O(u(qe,{onClose:o},null,512),[[L,"login"==t.value]]),O(u(Be,{onClose:o},null,512),[[L,"reg"==t.value]]),m("div",Re,[C(q("login"==t.value?"还没有账号":" 已有账号？")+" ",1),u(x(I),{text:"",onClick:a[0]||(a[0]=e=>{return a="reg"==t.value?"login":"reg",void(t.value=a);var a})},{default:V((()=>[C(" 立即"+q("login"==t.value?"注册":" 登录"),1)])),_:1})])])])])),_:1}))}},[["__scopeId","data-v-24057d48"]]),We=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Qe}),Xe=e=>{M((()=>Promise.resolve().then((function(){return We}))),void 0).then((a=>{const l=K(Qe,{modelValue:!0,type:e,onClose:()=>{setTimeout((()=>{H(null,document.body)}),300)}});H(l,document.body)}))};export{Xe as c};
