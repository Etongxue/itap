var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,a=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&r(e,n,t[n]);if(o)for(var n of o(t))i.call(t,n)&&r(e,n,t[n]);return e},s=(e,o)=>t(e,n(o));import{r as u,c,g as d,e as v,i as b,f as g}from"./style.83568f4e.js";import{v as m,k as f,r as p,b9 as y,ac as x,b1 as w,b3 as C,bn as k,a2 as L,b6 as j,bN as O,al as h,f as P}from"./todo.9d8ad3e1.js";import{u as A}from"./index.6fb72867.js";import{u as $}from"./index.172974c9.js";import"./isObject.44842e39.js";let B;const V=function(e={}){if(!O)return;const t=E(e);if(t.fullscreen&&B)return B;const n=function(e){let t;const n=A("loading"),o=f(!1),l=p(s(a({},e),{originalPosition:"",originalOverflow:"",visible:!1}));function i(){const e=l.parent;if(!e.vLoadingAddClassList){let t=e.getAttribute("loading-number");t=Number.parseInt(t)-1,t?e.setAttribute("loading-number",t.toString()):(u(e,n.bm("parent","relative")),e.removeAttribute("loading-number")),u(e,n.bm("parent","hidden"))}r(),d.unmount()}function r(){var e,t;null==(t=null==(e=v.$el)?void 0:e.parentNode)||t.removeChild(v.$el)}function c(){o.value&&(o.value=!1,i())}const d=y({name:"ElLoading",setup:()=>()=>{const e=l.spinner||l.svg,t=x("svg",a({class:"circular",viewBox:l.svgViewBox?l.svgViewBox:"25 25 50 50"},e?{innerHTML:e}:{}),[x("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none"})]),o=l.text?x("p",{class:n.b("text")},[l.text]):void 0;return x(j,{name:n.b("fade"),onAfterLeave:c},{default:w((()=>[C(L("div",{style:{backgroundColor:l.background||""},class:[n.b("mask"),l.customClass,l.fullscreen?"is-fullscreen":""]},[x("div",{class:n.b("spinner")},[t,o])]),[[k,l.visible]])]))})}}),v=d.mount(document.createElement("div"));return s(a({},m(l)),{setText:function(e){l.text=e},removeElLoadingChild:r,close:function(){var n;e.beforeClose&&!e.beforeClose()||(l.parent.vLoadingAddClassList=void 0,o.value=!0,clearTimeout(t),t=window.setTimeout((()=>{o.value&&(o.value=!1,i())}),400),l.visible=!1,null==(n=e.closed)||n.call(e))},handleAfterLeave:c,vm:v,get $el(){return v.$el}})}(s(a({},t),{closed:()=>{var e;null==(e=t.closed)||e.call(t),t.fullscreen&&(B=void 0)}}));I(t,t.parent,n),N(t,t.parent,n),t.parent.vLoadingAddClassList=()=>N(t,t.parent,n);let o=t.parent.getAttribute("loading-number");return o=o?`${Number.parseInt(o)+1}`:"1",t.parent.setAttribute("loading-number",o),t.parent.appendChild(n.$el),h((()=>n.visible.value=t.visible)),t.fullscreen&&(B=n),n},E=e=>{var t,n,o,l;let i;return i=c(e.target)?null!=(t=document.querySelector(e.target))?t:document.body:e.target||document.body,{parent:i===document.body||e.body?document.body:i,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:i===document.body&&(null==(n=e.fullscreen)||n),lock:null!=(o=e.lock)&&o,customClass:e.customClass||"",visible:null==(l=e.visible)||l,target:i}},I=async(e,t,n)=>{const{nextZIndex:o}=$(),l={};if(e.fullscreen)n.originalPosition.value=d(document.body,"position"),n.originalOverflow.value=d(document.body,"overflow"),l.zIndex=o();else if(e.parent===document.body){n.originalPosition.value=d(document.body,"position"),await h();for(const t of["top","left"]){const n="top"===t?"scrollTop":"scrollLeft";l[t]=e.target.getBoundingClientRect()[t]+document.body[n]+document.documentElement[n]-Number.parseInt(d(document.body,`margin-${t}`),10)+"px"}for(const t of["height","width"])l[t]=`${e.target.getBoundingClientRect()[t]}px`}else n.originalPosition.value=d(t,"position");for(const[i,r]of Object.entries(l))n.$el.style[i]=r},N=(e,t,n)=>{const o=A("loading");"absolute"!==n.originalPosition.value&&"fixed"!==n.originalPosition.value?v(t,o.bm("parent","relative")):u(t,o.bm("parent","relative")),e.fullscreen&&e.lock?v(t,o.bm("parent","hidden")):u(t,o.bm("parent","hidden"))},S=Symbol("ElLoading"),T=(e,t)=>{var n,o,l,i;const r=t.instance,a=e=>b(t.value)?t.value[e]:void 0,s=t=>(e=>{const t=c(e)&&(null==r?void 0:r[e])||e;return t?f(t):t})(a(t)||e.getAttribute(`element-loading-${g(t)}`)),u=null!=(n=a("fullscreen"))?n:t.modifiers.fullscreen,d={text:s("text"),svg:s("svg"),svgViewBox:s("svgViewBox"),spinner:s("spinner"),background:s("background"),customClass:s("customClass"),fullscreen:u,target:null!=(o=a("target"))?o:u?void 0:e,body:null!=(l=a("body"))?l:t.modifiers.body,lock:null!=(i=a("lock"))?i:t.modifiers.lock};e[S]={options:d,instance:V(d)}},D={mounted(e,t){t.value&&T(e,t)},updated(e,t){const n=e[S];t.oldValue!==t.value&&(t.value&&!t.oldValue?T(e,t):t.value&&t.oldValue?b(t.value)&&((e,t)=>{for(const n of Object.keys(t))P(t[n])&&(t[n].value=e[n])})(t.value,n.options):null==n||n.instance.close())},unmounted(e){var t;null==(t=e[S])||t.instance.close()}},R={install(e){e.directive("loading",D),e.config.globalProperties.$loading=V},directive:D,service:V};export{R as ElLoading,D as ElLoadingDirective,V as ElLoadingService,R as default,D as vLoading};
