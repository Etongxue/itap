import{a as e}from"./index.9334a195.js";import{bu as a,r as s,ay as i,W as o,X as t,x as l,D as r,V as c,a2 as p,b1 as m,U as n,I as d,aE as f,a1 as b,aB as u,az as j,br as x,bt as g}from"./todo.9d8ad3e1.js";import{a as k}from"./timeFormat.ead8e02a.js";/* empty css             */import{E as v}from"./el-progress.4b1fedf9.js";import{a as V,E as C}from"./el-checkbox-group.8feecd60.js";/* empty css                  *//* empty css                   */import{E as _}from"./el-dialog.78f7c2e8.js";/* empty css                   *//* empty css                   */import{u as h}from"./main.bc43ff04.js";import{c as y}from"./create_login.8330b0f6.js";import{A as w,w as Y}from"./public-api.2bc03c02.js";import{SAVE_CONFIG as E}from"./save_config.acf4dfbd.js";import D from"./hisBackup.9821eee1.js";import{u as A}from"./baseRequest.acdd10d1.js";import{ElButton as M}from"./index.7243f2d8.js";import{ElMessage as T}from"./index.8c1ac3e2.js";import{ElLoading as U}from"./index.bc9015df.js";import"./index.88f3c51b.js";import"./style.83568f4e.js";import"./index.6fb72867.js";import"./isObject.44842e39.js";import"./icon.b571cc89.js";import"./scroll.d4cf4dfc.js";import"./focus-trap.50913811.js";import"./aria.66f3f71c.js";import"./typescript.72bf8adc.js";import"./index.b2ab0f23.js";import"./index.90c48122.js";import"./index.f979cd8a.js";import"./index.8ef2203f.js";import"./index.172974c9.js";/* empty css                 */import"./el-form-item.a30a099f.js";import"./_baseClone.48fb5fa9.js";import"./_baseIsEqual.33a0d23b.js";import"./isEqual.060206f9.js";import"./el-radio.fafbbf94.js";import"./index.469ed053.js";import"./index.cf2b56e1.js";import"./index.becf6c0c.js";import"./el-image-viewer.373c54a1.js";import"./throttle.8deae385.js";import"./debounce.86275fe6.js";import"./position.c5cd7449.js";import"./Refresh.84dfc6ef.js";import"./website.ab9ea580.js";import"./index.1756df45.js";/* empty css                */import"./Loading.a57c2d0d.js";import"./Close.ac61f2f5.js";import"./config-provider.31e0a14a.js";/* empty css                       */import"./index.20caaeba.js";import"./event.0bae16b8.js";import"./validator.bcd39c35.js";const q=e=>(u("data-v-9be6a4c4"),e=e(),j(),e),z=[q((()=>t("a",null,"同步到本地",-1)))],I={key:0,class:"mt20 setting-li-sub"},O=[q((()=>t("a",null,"立即备份",-1)))],R=[q((()=>t("a",null,"管理历史备份",-1)))],B=q((()=>t("br",null,null,-1))),F=[q((()=>t("a",null,"导出数据",-1)))],H=q((()=>t("a",null,"从本地恢复",-1))),J={class:"p20 ac"},N={class:"ac mb20"},S=b("取消"),L=b("导出");var W=a({__name:"backup",setup(a){const u=A();h();const j=[{label:"设置",value:"baseConfig"},{label:"图标",value:"navConfig"},{label:"备忘录",value:"notes"},{label:"待办",value:"todo"}];function q(){W()&&(X.backupVisible=!0)}function W(){let e=x.get("token");return e||(y("login"),T.warning("请登录后使用同步功能")),!!e}const X=s({backupVisible:!1,exportVisible:!1,exportCheck:["baseConfig","navConfig","notes","todo"]});function G(e){if(!W())return;const a=U.service({lock:!0,text:"数据同步中",background:"rgba(0, 0, 0, 0.7)"});setTimeout((()=>{a.close()}),500),"backup"==e?E(null,100,"manua"):w()}const K=e=>{var a=new FileReader;a.readAsText(e.raw),a.onload=()=>{const e=JSON.parse(a.result);e?(Y(e),T.success("恢复成功")):T.error("数据格式可能不正确")}},P=()=>{let a={};X.exportCheck.forEach((e=>{a[e]=x.get(e)||[]})),e(JSON.stringify(a),g().format("YYYYMMDD")+".itabdata")};return(e,a)=>(i(),o("span",null,[t("p",{class:"setting-li",onClick:a[0]||(a[0]=e=>G("async"))},z),l(u).itabAsyncTime?(i(),o("h2",I,"上次备份: "+r(l(k)(l(u).itabAsyncTime.baseConfig,"YYYY-MM-DD HH:mm:ss")),1)):c("",!0),t("p",{class:"setting-li",onClick:a[1]||(a[1]=e=>G("backup"))},O),t("p",{class:"setting-li",onClick:q},R),B,t("p",{class:"setting-li",onClick:a[2]||(a[2]=e=>X.exportVisible=!0)},F),p(l(v),{action:"/","show-file-list":!1,multiple:!1,"auto-upload":!1,"on-change":K,class:"backup-import setting-li"},{default:m((()=>[H])),_:1}),X.backupVisible?(i(),n(D,{key:1,modelValue:X.backupVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>X.backupVisible=e)},null,8,["modelValue"])):c("",!0),p(l(_),{modelValue:X.exportVisible,"onUpdate:modelValue":a[6]||(a[6]=e=>X.exportVisible=e),title:"选择导出内容",width:"600px"},{footer:m((()=>[t("div",N,[p(l(M),{size:"default",onClick:a[5]||(a[5]=e=>X.exportVisible=!1)},{default:m((()=>[S])),_:1}),p(l(M),{size:"default",class:"ml10",type:"primary",onClick:P},{default:m((()=>[L])),_:1})])])),default:m((()=>[t("div",J,[p(l(V),{modelValue:X.exportCheck,"onUpdate:modelValue":a[4]||(a[4]=e=>X.exportCheck=e)},{default:m((()=>[(i(),o(d,null,f(j,(e=>p(l(C),{key:e.value,label:e.value},{default:m((()=>[b(r(e.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-9be6a4c4"]]);export{W as default};
