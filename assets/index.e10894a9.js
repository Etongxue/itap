import{d as e}from"./style.83568f4e.js";import{a as t}from"./position.c5cd7449.js";import{t as l,g as n}from"./scroll.d4cf4dfc.js";import{t as o}from"./throttle.8deae385.js";import{al as i}from"./todo.9d8ad3e1.js";import"./debounce.86275fe6.js";import"./isObject.44842e39.js";const s="ElInfiniteScroll",c={delay:{type:Number,default:200},distance:{type:Number,default:0},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},r=(e,t)=>Object.entries(c).reduce(((l,[n,o])=>{var i,s;const{type:c,default:r}=o,a=e.getAttribute(`infinite-scroll-${n}`);let d=null!=(s=null!=(i=t[a])?i:a)?s:r;return d="false"!==d&&d,d=c(d),l[n]=Number.isNaN(d)?r:d,l}),{}),a=e=>{const{observer:t}=e[s];t&&(t.disconnect(),delete e[s].observer)},d=(e,l)=>{const{container:n,containerEl:o,instance:i,observer:c,lastScrollTop:a}=e[s],{disabled:d,distance:u}=r(e,i),{clientHeight:f,scrollHeight:m,scrollTop:b}=o,p=b-a;if(e[s].lastScrollTop=b,c||d||p<0)return;let v=!1;if(n===e)v=m-(f+b)<=u;else{const{clientTop:l,scrollHeight:n}=e;v=b+f>=t(e,o)+l+n-u}v&&l.call(i)};function u(e,t){const{containerEl:l,instance:n}=e[s],{disabled:o}=r(e,n);o||0===l.clientHeight||(l.scrollHeight<=l.clientHeight?t.call(n):a(e))}const f={async mounted(t,c){const{instance:a,value:f}=c;e(f)||l(s,"'v-infinite-scroll' binding value must be a function"),await i();const{delay:m,immediate:b}=r(t,a),p=n(t,!0),v=p===window?document.documentElement:p,y=o(d.bind(null,t,f),m);if(p){if(t[s]={instance:a,container:p,containerEl:v,delay:m,cb:f,onScroll:y,lastScrollTop:v.scrollTop},b){const e=new MutationObserver(o(u.bind(null,t,f),50));t[s].observer=e,e.observe(t,{childList:!0,subtree:!0}),u(t,f)}p.addEventListener("scroll",y)}},unmounted(e){const{container:t,onScroll:l}=e[s];null==t||t.removeEventListener("scroll",l),a(e)},async updated(e){e[s]||await i();const{containerEl:t,cb:l,observer:n}=e[s];t.clientHeight&&n&&u(e,l)},install:e=>{e.directive("InfiniteScroll",f)}},m=f;export{m as ElInfiniteScroll,f as default};
