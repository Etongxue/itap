var e=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,u=(r,a,t)=>a in r?e(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t;import{bP as i,a4 as s,k as o,r as m,Q as c,aY as d,as as p,ax as b,ay as f,W as v,b3 as N,x as y,A as x,bo as g,a2 as V,b1 as h,U as I,V as j,bp as w}from"./todo.9d8ad3e1.js";import{E as S}from"./index.469ed053.js";import{b as O,g as A,E as k,_ as E,w as F}from"./index.88f3c51b.js";import{f as P,H as _,e as K,q as B}from"./icon.b571cc89.js";import{d as C,u as M,e as T}from"./index.90c48122.js";import{C as z,I as Y,U as $,u as D}from"./index.b2ab0f23.js";import{i as U}from"./focus-trap.50913811.js";import{u as q}from"./index.6fb72867.js";import{a as G}from"./index.f979cd8a.js";import{d as H}from"./scroll.d4cf4dfc.js";import{c as Q}from"./style.83568f4e.js";import{v as W}from"./index.5b03a4eb.js";const J=O({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,disabled:Boolean,size:C,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||i(e)||["min","max"].includes(e),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)}}),L={[z]:(e,r)=>e!==r,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Y]:e=>i(e)||U(e),[$]:e=>i(e)||U(e)},R=["aria-label","onKeydown"],X=["aria-label","onKeydown"],Z=s((ee=((e,r)=>{for(var a in r||(r={}))l.call(r,a)&&u(e,a,r[a]);if(t)for(var a of t(r))n.call(r,a)&&u(e,a,r[a]);return e})({},{name:"ElInputNumber"}),r(ee,a({props:J,emits:L,setup(e,{expose:r,emit:a}){const t=e,{t:l}=D(),n=q("input-number"),u=o(),s=m({currentValue:t.modelValue,userInput:null}),{formItem:O}=G(),E=c((()=>i(t.modelValue)&&ee(t.modelValue,-1)<t.min)),F=c((()=>i(t.modelValue)&&ee(t.modelValue)>t.max)),C=c((()=>{const e=Z(t.step);return A(t.precision)?Math.max(Z(t.modelValue),e):(t.precision,t.precision)})),z=c((()=>t.controls&&"right"===t.controlsPosition)),Y=M(),$=T(),J=c((()=>{if(null!==s.userInput)return s.userInput;let e=s.currentValue;if(U(e))return"";if(i(e)){if(Number.isNaN(e))return"";A(t.precision)||(e=e.toFixed(t.precision))}return e})),L=(e,r)=>{if(A(r)&&(r=C.value),0===r)return Math.round(e);let a=String(e);const t=a.indexOf(".");if(-1===t)return e;if(!a.replace(".","").split("")[t+r])return e;const l=a.length;return"5"===a.charAt(l-1)&&(a=`${a.slice(0,Math.max(0,l-1))}6`),Number.parseFloat(Number(a).toFixed(r))},Z=e=>{if(U(e))return 0;const r=e.toString(),a=r.indexOf(".");let t=0;return-1!==a&&(t=r.length-a-1),t},ee=(e,r=1)=>i(e)?L(e+t.step*r):s.currentValue,re=()=>{if($.value||F.value)return;const e=t.modelValue||0,r=ee(e);le(r)},ae=()=>{if($.value||E.value)return;const e=t.modelValue||0,r=ee(e,-1);le(r)},te=(e,r)=>{const{max:l,min:n,step:u,precision:i,stepStrictly:s,valueOnClear:o}=t;let m=Number(e);if(U(e)||Number.isNaN(m))return null;if(""===e){if(null===o)return null;m=Q(o)?{min:n,max:l}[o]:o}return s&&(m=Math.round(m/u)*u),A(i)||(m=L(m,i)),(m>l||m<n)&&(m=m>l?l:n,r&&a("update:modelValue",m)),m},le=e=>{var r;const t=s.currentValue,l=te(e);t!==l&&(s.userInput=null,a("update:modelValue",l),a("input",l),a("change",l,t),null==(r=null==O?void 0:O.validate)||r.call(O,"change").catch((e=>H())),s.currentValue=l)},ne=e=>s.userInput=e,ue=e=>{const r=""!==e?Number(e):"";(i(r)&&!Number.isNaN(r)||""===e)&&le(r),s.userInput=null},ie=e=>{a("focus",e)},se=e=>{var r;a("blur",e),null==(r=null==O?void 0:O.validate)||r.call(O,"blur").catch((e=>H()))};return d((()=>t.modelValue),(e=>{s.currentValue=te(e,!0),s.userInput=null}),{immediate:!0}),p((()=>{var e;const{min:r,max:l,modelValue:n}=t,o=null==(e=u.value)?void 0:e.input;if(o.setAttribute("role","spinbutton"),Number.isFinite(l)?o.setAttribute("aria-valuemax",String(l)):o.removeAttribute("aria-valuemax"),Number.isFinite(r)?o.setAttribute("aria-valuemin",String(r)):o.removeAttribute("aria-valuemin"),o.setAttribute("aria-valuenow",String(s.currentValue)),o.setAttribute("aria-disabled",String($.value)),!i(n)&&null!=n){let e=Number(n);Number.isNaN(e)&&(e=null),a("update:modelValue",e)}})),b((()=>{var e;const r=null==(e=u.value)?void 0:e.input;null==r||r.setAttribute("aria-valuenow",`${s.currentValue}`)})),r({focus:()=>{var e,r;null==(r=null==(e=u.value)?void 0:e.focus)||r.call(e)},blur:()=>{var e,r;null==(r=null==(e=u.value)?void 0:e.blur)||r.call(e)}}),(e,r)=>(f(),v("div",{class:x([y(n).b(),y(n).m(y(Y)),y(n).is("disabled",y($)),y(n).is("without-controls",!e.controls),y(n).is("controls-right",y(z))]),onDragstart:r[0]||(r[0]=w((()=>{}),["prevent"]))},[e.controls?N((f(),v("span",{key:0,role:"button","aria-label":y(l)("el.inputNumber.decrease"),class:x([y(n).e("decrease"),y(n).is("disabled",y(E))]),onKeydown:g(ae,["enter"])},[V(y(k),null,{default:h((()=>[y(z)?(f(),I(y(P),{key:0})):(f(),I(y(_),{key:1}))])),_:1})],42,R)),[[y(W),ae]]):j("v-if",!0),e.controls?N((f(),v("span",{key:1,role:"button","aria-label":y(l)("el.inputNumber.increase"),class:x([y(n).e("increase"),y(n).is("disabled",y(F))]),onKeydown:g(re,["enter"])},[V(y(k),null,{default:h((()=>[y(z)?(f(),I(y(K),{key:0})):(f(),I(y(B),{key:1}))])),_:1})],42,X)),[[y(W),re]]):j("v-if",!0),V(y(S),{id:e.id,ref_key:"input",ref:u,type:"number",step:e.step,"model-value":y(J),placeholder:e.placeholder,disabled:y($),size:y(Y),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onKeydown:[g(w(re,["prevent"]),["up"]),g(w(ae,["prevent"]),["down"])],onBlur:se,onFocus:ie,onInput:ne,onChange:ue},null,8,["id","step","model-value","placeholder","disabled","size","max","min","name","label","onKeydown"])],34))}}))));var ee;const re=F(E(Z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]));export{re as E};
