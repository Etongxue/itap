import{a}from"./index.e4e38f05.js";import{cc as e,dr as s,r as l,ay as o,W as t,X as i,x as c,D as n,V as r,a2 as u,b1 as p,U as m,bD as d,I as b,aE as f,a1 as k,aB as g,az as j,c7 as x,cb as V,cq as v,dx as C,d_ as _,bx as h}from"./save_config.7e387697.js";import{a as y}from"./timeFormat.59b65a7c.js";import{E as Y}from"./el-upload.94e2512c.js";import{u as E,ad as D}from"./main.5f87c81f.js";import{a as w,E as z}from"./el-checkbox-group.263c9314.js";import{E as M}from"./el-overlay.e22515de.js";import{c as T}from"./create_login.823c0dbe.js";import U from"./hisBackup.5d08dc4a.js";import"./el-input.07836306.js";import"./zoom-in.275d1c48.js";import"./validator2.fec6f1ba.js";import"./el-form-item.9774cccc.js";import"./_baseClone.36822d61.js";import"./_baseIsEqual.840160ed.js";import"./isEqual.8b269055.js";import"./el-radio.2ecd3578.js";import"./index2.948aebda.js";import"./index2.ebb82d9e.js";import"./event2.b0442ad9.js";const q=a=>(g("data-v-9be6a4c4"),a=a(),j(),a),A=[q((()=>i("a",null,"同步到本地",-1)))],I={key:0,class:"mt20 setting-li-sub"},B=[q((()=>i("a",null,"立即备份",-1)))],F=[q((()=>i("a",null,"管理历史备份",-1)))],H=q((()=>i("br",null,null,-1))),J=[q((()=>i("a",null,"导出数据",-1)))],N=q((()=>i("a",null,"从本地恢复",-1))),O={class:"p20 ac"},S={class:"ac mb20"},R=k("取消"),W=k("导出");var X=e({setup(e){const g=s();E();const j=[{label:"设置",value:"baseConfig"},{label:"图标",value:"navConfig"},{label:"备忘录",value:"notes"},{label:"待办",value:"todo"}];function q(){X()&&(G.backupVisible=!0)}function X(){let a=x.get("token");return a||(T("login"),V.warning("请登录后使用同步功能")),!!a}const G=l({backupVisible:!1,exportVisible:!1,exportCheck:["baseConfig","navConfig","notes","todo"]});function K(a){if(!X())return;const e=D.service({lock:!0,text:"数据同步中",background:"rgba(0, 0, 0, 0.7)"});setTimeout((()=>{e.close()}),500),"backup"==a?v(null,100,"manua"):C()}const L=a=>{var e=new FileReader;e.readAsText(a.raw),e.onload=()=>{const a=JSON.parse(e.result);a?(_(a),V.success("恢复成功")):V.error("数据格式可能不正确")}},P=()=>{let e={};G.exportCheck.forEach((a=>{e[a]=x.get(a)||[]})),a(JSON.stringify(e),h().format("YYYYMMDD")+".itabdata")};return(a,e)=>(o(),t("span",null,[i("p",{class:"setting-li",onClick:e[0]||(e[0]=a=>K("async"))},A),c(g).itabAsyncTime?(o(),t("h2",I,"上次备份: "+n(c(y)(c(g).itabAsyncTime.baseConfig,"YYYY-MM-DD HH:mm:ss")),1)):r("",!0),i("p",{class:"setting-li",onClick:e[1]||(e[1]=a=>K("backup"))},B),i("p",{class:"setting-li",onClick:q},F),H,i("p",{class:"setting-li",onClick:e[2]||(e[2]=a=>c(G).exportVisible=!0)},J),u(c(Y),{action:"/","show-file-list":!1,multiple:!1,"auto-upload":!1,"on-change":L,class:"backup-import setting-li"},{default:p((()=>[N])),_:1}),c(G).backupVisible?(o(),m(U,{key:1,modelValue:c(G).backupVisible,"onUpdate:modelValue":e[3]||(e[3]=a=>c(G).backupVisible=a)},null,8,["modelValue"])):r("",!0),u(c(M),{modelValue:c(G).exportVisible,"onUpdate:modelValue":e[6]||(e[6]=a=>c(G).exportVisible=a),title:"选择导出内容",width:"600px"},{footer:p((()=>[i("div",S,[u(c(d),{size:"default",onClick:e[5]||(e[5]=a=>c(G).exportVisible=!1)},{default:p((()=>[R])),_:1}),u(c(d),{size:"default",class:"ml10",type:"primary",onClick:P},{default:p((()=>[W])),_:1})])])),default:p((()=>[i("div",O,[u(c(w),{modelValue:c(G).exportCheck,"onUpdate:modelValue":e[4]||(e[4]=a=>c(G).exportCheck=a)},{default:p((()=>[(o(),t(b,null,f(j,(a=>u(c(z),{key:a.value,label:a.value},{default:p((()=>[k(n(a.label),1)])),_:2},1032,["label"]))),64))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-9be6a4c4"]]);export{X as default};
